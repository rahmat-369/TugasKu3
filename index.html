<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>TugasKu - Update Tahap 3 v1.2.0</title>
  <meta name="app-version" content="1.2.0">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/png" href="my-icon.png">
  <style>
    /* CSS Variables & Base Styles */
    :root {
      --primary: #3B82F6;
      --primary-600: #2563EB;
      --bg: #f8fafc;
      --card: #ffffff;
      --muted: #6b7280;
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;
      --glass: rgba(255,255,255,0.5);
      --radius: 14px;
      --shadow: 0 6px 18px rgba(16,24,40,0.06);
      --priority-high: #ef4444;
      --priority-medium: #f59e0b;
      --priority-low: #10b981;
      --theme-colorful-1: #8B5CF6;
      --theme-colorful-2: #EC4899;
      --theme-colorful-3: #F97316;
      --theme-colorful-gradient: linear-gradient(135deg, var(--theme-colorful-1), var(--theme-colorful-2));
      --theme-forest-1: #10b981;
      --theme-forest-2: #059669;
      --theme-forest-3: #ecfdf5;
      --theme-forest-gradient: linear-gradient(135deg, var(--theme-forest-1), var(--theme-forest-2));
      --theme-ocean-1: #0ea5e9;
      --theme-ocean-2: #0284c7;
      --theme-ocean-3: #f0f9ff;
      --theme-ocean-gradient: linear-gradient(135deg, var(--theme-ocean-1), var(--theme-ocean-2));
      --theme-sakura-1: #f472b6;
      --theme-sakura-2: #ec4899;
      --theme-sakura-3: #fff1f2;
      --theme-sakura-gradient: linear-gradient(135deg, var(--theme-sakura-1), var(--theme-sakura-2));
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    .dark-mode {
      --bg: #0b1220;
      --card: #0f1724;
      --muted: #cbd5e1;
      --glass: rgba(20,25,34,0.6);
      color-scheme: dark;
      color: #e6eef8;
    }
    .colorful-mode {
      --primary: #8B5CF6;
      --primary-600: #7C3AED;
      --bg: #fdf4ff;
      --card: #ffffff;
      --muted: #6b7280;
      --glass: rgba(255,255,255,0.7);
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;
      color: #1f2937;
    }
    .dark-mode.colorful-mode {
      --bg: #1e1b2e;
      --card: #2a2540;
      --muted: #d1d5db;
      --glass: rgba(42,37,64,0.7);
      color: #f3f4f6;
    }
    .forest-mode {
      --primary: #10b981;
      --primary-600: #059669;
      --bg: #ecfdf5;
      --card: #ffffff;
      --muted: #6b7280;
      --glass: rgba(255,255,255,0.7);
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;
      color: #0f1724;
    }
    .dark-mode.forest-mode {
      --bg: #064e3b;
      --card: #047857;
      --muted: #a7f3d0;
      --glass: rgba(4, 120, 87, 0.7);
      color: #d1fae5;
    }
    .dark-mode.ocean-mode {
      --bg: #082f49;
      --card: #0c4a6e;
      --muted: #bae6fd;
      color: #bae6fd;
    }
    .dark-mode.sakura-mode {
      --bg: #881337;
      --card: #9f1239;
      --muted: #fecdd3;
      color: #fecdd3;
    }
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    html, body {
      height: 100%;
      overflow-x: hidden;
    }
    body {
      background: linear-gradient(180deg, var(--bg), #f1f5f9);
      min-height: 100vh;
      color: #0f1724;
      padding: 0;
      transition: background .25s, color .25s;
      -webkit-font-smoothing: antialiased;
      display: flex;
      flex-direction: column;
    }
    .dark-mode input,
    .dark-mode textarea,
    .dark-mode select {
      color: #e6eef8;
      border-color: rgba(255,255,255,0.1);
      background: rgba(255,255,255,0.02);
    }
    .dark-mode.colorful-mode input,
    .dark-mode.colorful-mode textarea,
    .dark-mode.colorful-mode select,
    .dark-mode.forest-mode input,
    .dark-mode.forest-mode textarea,
    .dark-mode.forest-mode select,
    .dark-mode.ocean-mode input,
    .dark-mode.ocean-mode textarea,
    .dark-mode.ocean-mode select,
    .dark-mode.sakura-mode input,
    .dark-mode.sakura-mode textarea,
    .dark-mode.sakura-mode select {
      color: #cbd5e1;
    }
    /* Container */
    .container {
      max-width: 100%;
      margin: 0 auto;
      padding: 12px;
      width: 100%;
      flex: 1;
      padding-bottom: 80px;
    }
    header {
      position: sticky;
      top: 12px;
      z-index: 40;
      margin-bottom: 18px;
      background: linear-gradient(180deg, rgba(255,255,255,0.55), rgba(255,255,255,0.40));
      backdrop-filter: blur(8px) saturate(120%);
      border-radius: 14px;
      box-shadow: var(--shadow);
      padding: 12px 16px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      border: 1px solid rgba(16,24,40,0.04);
      flex-wrap: wrap;
    }
    .dark-mode header,
    .dark-mode.colorful-mode header,
    .dark-mode.forest-mode header,
    .dark-mode.ocean-mode header,
    .dark-mode.sakura-mode header {
      background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
      border: 1px solid rgba(255,255,255,0.04);
    }
    .brand {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .logo {
      width: 40px;
      height: 40px;
      font-size: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 10px;
      background: var(--primary);
      color: #fff;
      flex-shrink: 0;
    }
    .logo .app-icon {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
      border-radius: 8px;
    }
    .brand h1 {
      font-size: 20px;
      font-weight: 700;
    }
    .header-actions {
      display: flex;
      gap: 8px;
      align-items: center;
    }
    .icon-btn {
      width: 36px;
      height: 36px;
      border-radius: 999px;
      border: 1px solid rgba(0,0,0,0.04);
      background: var(--card);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: transform 0.1s;
      position: relative;
    }
    .dark-mode .icon-btn,
    .dark-mode.colorful-mode .icon-btn,
    .dark-mode.forest-mode .icon-btn,
    .dark-mode.ocean-mode .icon-btn,
    .dark-mode.sakura-mode .icon-btn {
      border-color: rgba(255,255,255,0.04);
    }
    .icon-btn:active {
      transform: scale(0.95);
    }
    /* Menu pengaturan */
    .settings-menu {
      position: absolute;
      top: 100%;
      right: 0;
      background: var(--card);
      border-radius: 12px;
      padding: 12px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.15);
      min-width: 200px;
      z-index: 50;
      display: none;
      margin-top: 8px;
      border: 1px solid rgba(0,0,0,0.05);
    }
    .dark-mode .settings-menu,
    .dark-mode.colorful-mode .settings-menu,
    .dark-mode.forest-mode .settings-menu,
    .dark-mode.ocean-mode .settings-menu,
    .dark-mode.sakura-mode .settings-menu {
      border-color: rgba(255,255,255,0.05);
    }
    .settings-menu.show {
      display: block;
    }
    .settings-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.2s;
    }
    .settings-item:hover {
      background: rgba(0,0,0,0.03);
    }
    .dark-mode .settings-item:hover,
    .dark-mode.colorful-mode .settings-item:hover,
    .dark-mode.forest-mode .settings-item:hover,
    .dark-mode.ocean-mode .settings-item:hover,
    .dark-mode.sakura-mode .settings-item:hover {
      background: rgba(255,255,255,0.05);
    }
    /* Tab Navigation */
    .tab-navigation {
      display: flex;
      background: rgba(0,0,0,0.03);
      padding: 4px;
      border-radius: 12px;
      margin-bottom: 20px;
    }
    .dark-mode .tab-navigation,
    .dark-mode.colorful-mode .tab-navigation,
    .dark-mode.forest-mode .tab-navigation,
    .dark-mode.ocean-mode .tab-navigation,
    .dark-mode.sakura-mode .tab-navigation {
      background: rgba(255,255,255,0.05);
    }
    .tab-btn {
      flex: 1;
      padding: 10px;
      border-radius: 10px;
      border: none;
      background: transparent;
      cursor: pointer;
      font-weight: 600;
      transition: background 0.2s;
    }
    .tab-btn.active {
      background: var(--card);
      box-shadow: var(--shadow);
    }
    .tab-content {
      display: none;
    }
    .tab-content.active {
      display: block;
    }
    /* Form & Field Styles */
    .form-section {
      background: var(--card);
      border-radius: 16px;
      padding: 20px;
      box-shadow: var(--shadow);
      margin-bottom: 20px;
    }
    .controls {
      display: flex;
      gap: 10px;
    }
    .field {
      margin-bottom: 16px;
      position: relative;
    }
    .field label {
      display: block;
      margin-bottom: 6px;
      font-weight: 600;
      font-size: 14px;
    }
    .field input,
    .field textarea,
    .field select {
      width: 100%;
      padding: 12px 14px;
      border-radius: 10px;
      border: 1px solid rgba(0,0,0,0.08);
      background: var(--glass);
      font-family: inherit;
      font-size: 15px;
      outline: 0;
      transition: border-color 0.2s, box-shadow 0.2s;
    }
    .field input:focus,
    .field textarea:focus,
    .field select:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(59,130,246,0.2);
    }
    .colorful-mode .field input:focus,
    .colorful-mode .field textarea:focus,
    .colorful-mode .field select:focus {
      border-color: var(--theme-colorful-1);
      box-shadow: 0 0 0 3px rgba(139,92,246,0.2);
    }
    .forest-mode .field input:focus,
    .forest-mode .field textarea:focus,
    .forest-mode .field select:focus {
      border-color: var(--theme-forest-1);
      box-shadow: 0 0 0 3px rgba(16,185,129,0.2);
    }
    .ocean-mode .field input:focus,
    .ocean-mode .field textarea:focus,
    .ocean-mode .field select:focus {
      border-color: var(--theme-ocean-1);
      box-shadow: 0 0 0 3px rgba(14,165,233,0.2);
    }
    .sakura-mode .field input:focus,
    .sakura-mode .field textarea:focus,
    .sakura-mode .field select:focus {
      border-color: var(--theme-sakura-1);
      box-shadow: 0 0 0 3px rgba(244,114,182,0.2);
    }
    /* Filter Section */
    .filter-section {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 20px;
    }
    .filter-btn {
      padding: 8px 14px;
      border-radius: 999px;
      border: 1px solid rgba(0,0,0,0.08);
      background: transparent;
      font-weight: 600;
      font-size: 14px;
      cursor: pointer;
      transition: background 0.2s, color 0.2s;
    }
    .dark-mode .filter-btn,
    .dark-mode.colorful-mode .filter-btn,
    .dark-mode.forest-mode .filter-btn,
    .dark-mode.ocean-mode .filter-btn,
    .dark-mode.sakura-mode .filter-btn {
      border-color: rgba(255,255,255,0.08);
    }
    .filter-btn.active,
    .filter-btn:hover {
      background: var(--primary);
      color: #fff;
      border-color: var(--primary);
    }
    .colorful-mode .filter-btn.active,
    .colorful-mode .filter-btn:hover {
      background: var(--theme-colorful-1);
      border-color: var(--theme-colorful-1);
    }
    .forest-mode .filter-btn.active,
    .forest-mode .filter-btn:hover {
      background: var(--theme-forest-1);
      border-color: var(--theme-forest-1);
    }
    .ocean-mode .filter-btn.active,
    .ocean-mode .filter-btn:hover {
      background: var(--theme-ocean-1);
      border-color: var(--theme-ocean-1);
    }
    .sakura-mode .filter-btn.active,
    .sakura-mode .filter-btn:hover {
      background: var(--theme-sakura-1);
      border-color: var(--theme-sakura-1);
    }
    /* Task Card */
    .task-card {
      background: var(--card);
      padding: 16px;
      border-radius: 14px;
      box-shadow: var(--shadow);
      margin-bottom: 12px;
      position: relative;
      border-left: 4px solid transparent;
      transition: transform .12s, box-shadow .12s;
      overflow: hidden;
    }
    .task-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(16,24,40,0.1);
    }
    .task-title {
      font-weight: 700;
      font-size: 18px;
      display: flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
      margin-bottom: 8px;
      padding-right: 140px;
    }
    /* Priority indicator (new) */
    .priority-indicator {
      width: 14px;
      height: 14px;
      border-radius: 50%;
      display: inline-block;
      flex-shrink: 0;
      margin-right: 8px;
      line-height: 14px;
      text-align: center;
      font-size: 12px;
    }
    .priority-high-indicator { background: var(--priority-high); }
    .priority-medium-indicator { background: var(--priority-medium); }
    .priority-low-indicator { background: var(--priority-low); }
    .task-title .title-text {
      display: inline-block;
      max-width: calc(100% - 140px);
      overflow-wrap: anywhere;
      word-break: break-word;
      white-space: normal;
    }
    .task-detail {
      font-size: 14px;
      color: var(--muted);
      display: flex;
      gap: 8px;
      align-items: center;
      flex-wrap: wrap;
      margin-bottom: 8px;
      padding-right: 120px;
      word-break: break-word;
    }
    .task-detail .long-text {
      max-height: 120px;
      overflow-y: auto;
      padding-right: 6px;
    }
    .task-actions {
      display: flex;
      gap: 8px;
      justify-content: flex-end;
      margin-top: 16px;
      padding-top: 12px;
      border-top: 1px solid rgba(0,0,0,0.05);
    }
    .dark-mode .task-actions {
      border-top-color: rgba(255,255,255,0.05);
    }
    .status-pill {
      position: absolute;
      top: 12px;
      right: 12px;
      padding: 4px 10px;
      border-radius: 999px;
      font-weight: 700;
      font-size: 12px;
      z-index: 30;
      pointer-events: none;
      white-space: nowrap;
    }
    /* Priority and deadline classes */
    .priority-high { border-left-color: var(--priority-high); }
    .priority-medium { border-left-color: var(--priority-medium); }
    .priority-low { border-left-color: var(--priority-low); }
    .dl-ok { border-left-color: var(--success); }
    .dl-soon { border-left-color: var(--warning); }
    .dl-urgent { border-left-color: var(--danger); }
    .dl-overdue { border-left-color: #6b7280; opacity: 0.85; }
    /* Priority badge kept for compatibility but not used visually by default */
    .priority-badge {
      padding: 4px 8px;
      border-radius: 6px;
      font-size: 11px;
      font-weight: 700;
      margin-left: auto;
    }
    .priority-high-badge { background-color: var(--priority-high); color: white; }
    .priority-medium-badge { background-color: var(--priority-medium); color: white; }
    .priority-low-badge { background-color: var(--priority-low); color: white; }
    /* FAB */
    .fab {
      position: fixed;
      right: 20px;
      bottom: calc(20px + env(safe-area-inset-bottom));
      width: 60px;
      height: 60px;
      border-radius: 999px;
      background: linear-gradient(135deg, var(--primary), var(--primary-600));
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-size: 24px;
      box-shadow: 0 18px 40px rgba(59,130,246,0.22);
      cursor: pointer;
      border: 0;
      z-index: 60;
      transition: transform 0.2s;
    }
    .colorful-mode .fab {
      background: var(--theme-colorful-gradient);
    }
    .forest-mode .fab {
      background: var(--theme-forest-gradient);
    }
    .ocean-mode .fab {
      background: var(--theme-ocean-gradient);
    }
    .sakura-mode .fab {
      background: var(--theme-sakura-gradient);
    }
    .fab:active {
      transform: scale(0.95);
    }
    /* Toast */
    .toast {
      position: fixed;
      left: 50%;
      transform: translateX(-50%);
      bottom: 100px;
      background: #111;
      color: #fff;
      padding: 12px 18px;
      border-radius: 10px;
      opacity: 0;
      pointer-events: none;
      transition: opacity .2s;
      z-index: 80;
      font-size: 14px;
      text-align: center;
      max-width: 80%;
    }
    .toast.show {
      opacity: 1;
      pointer-events: auto;
    }
    /* Watermark */
    .watermark {
      position: fixed;
      left: 12px;
      bottom: 12px;
      font-size: 12px;
      color: var(--muted);
      opacity: 0.28;
      pointer-events: none;
      z-index: 70;
      background: transparent;
      padding: 4px 6px;
      border-radius: 8px;
    }
    .dark-mode .watermark,
    .dark-mode.colorful-mode .watermark,
    .dark-mode.forest-mode .watermark,
    .dark-mode.ocean-mode .watermark,
    .dark-mode.sakura-mode .watermark {
      color: #cbd5e1;
      opacity: 0.18;
    }
    /* Empty State */
    .empty-state {
      text-align: center;
      padding: 40px 20px;
      color: var(--muted);
    }
    .empty-state h3 {
      margin-bottom: 8px;
    }
    /* Button Styles */
    .btn {
      background: var(--primary);
      color: #fff;
      padding: 10px 16px;
      border-radius: 10px;
      border: 0;
      font-weight: 600;
      cursor: pointer;
      font-size: 14px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.1s, box-shadow 0.1s;
    }
    .colorful-mode .btn {
      background: var(--theme-colorful-gradient);
    }
    .forest-mode .btn {
      background: var(--theme-forest-gradient);
    }
    .ocean-mode .btn {
      background: var(--theme-ocean-gradient);
    }
    .sakura-mode .btn {
      background: var(--theme-sakura-gradient);
    }
    .btn:active {
      transform: scale(0.98);
    }
    /* Schedule styles */
    .schedule-day {
      margin-bottom: 20px;
    }
    .schedule-header {
      font-weight: 700;
      font-size: 18px;
      margin-bottom: 12px;
      padding-bottom: 8px;
      border-bottom: 1px solid rgba(0,0,0,0.06);
    }
    .dark-mode .schedule-header,
    .dark-mode.colorful-mode .schedule-header,
    .dark-mode.forest-mode .schedule-header,
    .dark-mode.ocean-mode .schedule-header,
    .dark-mode.sakura-mode .schedule-header {
      border-bottom-color: rgba(255,255,255,0.06);
    }
    .schedule-item {
      background: var(--card);
      padding: 14px;
      border-radius: 10px;
      margin-bottom: 10px;
      box-shadow: var(--shadow);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .schedule-time {
      font-weight: 600;
      color: var(--primary);
      min-width: 80px;
    }
    .schedule-subject {
      font-weight: 600;
      flex: 1;
      margin: 0 12px;
    }
    /* About page styles */
    .about-section {
      background: var(--card);
      border-radius: 16px;
      padding: 20px;
      box-shadow: var(--shadow);
      margin-bottom: 20px;
    }
    .about-logo {
      text-align: center;
      margin-bottom: 20px;
    }
    .about-logo .logo {
      width: 80px;
      height: 80px;
      font-size: 36px;
      margin: 0 auto 16px;
      padding: 6px;
    }
    .about-logo .logo .app-icon {
      border-radius: 12px;
    }
    .feature-list {
      margin: 16px 0;
      padding-left: 20px;
    }
    .feature-list li {
      margin-bottom: 8px;
    }
    .version-info {
      text-align: center;
      margin-top: 24px;
      padding-top: 16px;
      border-top: 1px solid rgba(0,0,0,0.06);
    }
    .dark-mode .version-info,
    .dark-mode.colorful-mode .version-info,
    .dark-mode.forest-mode .version-info,
    .dark-mode.ocean-mode .version-info,
    .dark-mode.sakura-mode .version-info {
      border-top-color: rgba(255,255,255,0.06);
    }
    /* Modal styles */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 100;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s;
    }
    .modal-overlay.show {
      opacity: 1;
      pointer-events: auto;
    }
    .modal {
      background: var(--card);
      border-radius: 16px;
      padding: 24px;
      max-width: 90%;
      width: 400px;
      max-height: 80%;
      overflow-y: auto;
      box-shadow: 0 20px 40px rgba(0,0,0,0.2);
    }
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    .modal-close {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: var(--muted);
    }
    /* Badge for task count */
    .badge {
      position: absolute;
      top: -6px;
      right: -6px;
      min-width: 26px;
      height: 26px;
      border-radius: 999px;
      background: var(--danger);
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 13px;
      box-shadow: 0 4px 10px rgba(239,68,68,0.18);
    }
    /* Theme Selection Modal */
    .theme-option {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px;
      border-radius: 10px;
      cursor: pointer;
      transition: background 0.2s;
      margin-bottom: 8px;
    }
    .theme-option:hover {
      background: rgba(0,0,0,0.03);
    }
    .dark-mode .theme-option:hover,
    .dark-mode.colorful-mode .theme-option:hover,
    .dark-mode.forest-mode .theme-option:hover,
    .dark-mode.ocean-mode .theme-option:hover,
    .dark-mode.sakura-mode .theme-option:hover {
      background: rgba(255,255,255,0.05);
    }
    .theme-preview {
      width: 40px;
      height: 40px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
    }
    /* Notes styles */
    .note-card {
      background: var(--card);
      padding: 16px;
      border-radius: 14px;
      box-shadow: var(--shadow);
      margin-bottom: 12px;
      position: relative;
      transition: transform .12s, box-shadow .12s;
    }
    .note-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(16,24,40,0.1);
    }
    .note-title {
      font-weight: 700;
      font-size: 18px;
      margin-bottom: 8px;
      word-break: break-word;
    }
    .note-content {
      font-size: 14px;
      margin-bottom: 12px;
      word-break: break-word;
      white-space: pre-wrap;
      color: var(--muted);
      max-height: 160px;
      overflow-y: auto;
    }
    .note-meta {
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 12px;
    }
    .note-actions {
      display: flex;
      gap: 8px;
      justify-content: flex-end;
    }
    /* Stats Modal Styles */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 16px;
      margin-top: 16px;
    }
    .stat-card {
      background: var(--card);
      border-radius: 12px;
      padding: 16px;
      text-align: center;
      box-shadow: var(--shadow);
    }
    .stat-value {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 4px;
    }
    .stat-label {
      font-size: 14px;
      color: var(--muted);
    }
    /* Chart container */
    .chart-wrap {
      margin-top: 12px;
      background: transparent;
    }
    .chart-canvas {
      width: 100% !important;
      height: 220px !important;
    }
    /* Responsive */
    @media (max-width: 768px) {
      .header-actions {
        position: relative;
      }
      .settings-menu {
        min-width: 180px;
        right: 0;
        left: auto;
      }
      .brand h1 {
        font-size: 18px;
      }
      .logo {
        width: 36px;
        height: 36px;
      }
      .btn, .filter-btn {
        padding: 8px 12px;
        font-size: 13px;
      }
      .task-title {
        font-size: 16px;
        padding-right: 90px;
      }
      .task-title .title-text {
        max-width: calc(100% - 90px);
      }
      .task-detail {
        font-size: 13px;
      }
      .fab {
        width: 56px;
        height: 56px;
        font-size: 22px;
        bottom: 80px;
      }
      .priority-badge {
        font-size: 10px;
        padding: 3px 6px;
      }
      .task-actions {
        flex-wrap: wrap;
      }
    }
    @media (max-width: 480px) {
      .brand {
        gap: 8px;
      }
      .header-actions {
        justify-content: flex-end;
        width: 100%;
        margin-top: 8px;
      }
      .controls {
        justify-content: space-between;
        width: 100%;
      }
      .filter-section {
        gap: 6px;
      }
      .filter-btn {
        padding: 8px 12px;
        font-size: 13px;
      }
      .schedule-item {
        flex-direction: column;
        align-items: flex-start;
        gap: 8px;
      }
      .schedule-time {
        min-width: auto;
      }
      .task-title {
        flex-direction: column;
        align-items: flex-start;
        gap: 4px;
        padding-right: 12px;
      }
      .priority-badge {
        margin-left: 0;
      }
      .task-detail {
        flex-direction: column;
        align-items: flex-start;
        gap: 4px;
      }
      .note-title, .note-content {
        word-break: break-word;
      }
      .chart-canvas {
        height: 180px !important;
      }
    }
  </style>
</head>
<div id="splash" style="position:fixed;inset:0;z-index:9999;background:#000;display:flex;align-items:center;justify-content:center;">
  <img src="splash.png" alt="Splash" style="width:100%;height:100%;object-fit:cover;">
</div>

<div id="mainContent" style="display:none;">
  <!-- Semua isi web -->
</div>

<script>
  // Hilangkan splash setelah 2.5 detik
  setTimeout(()=>{
    document.getElementById('splash').style.display = 'none';
    document.getElementById('mainContent').style.display = 'block';
  }, 2500);
</script>
<body>
  <!-- Konten utama -->
  <div id="mainContent">
    <div class="container">
      <!-- Header -->
      <header>
        <div class="brand">
          <div class="logo">
            <img src="my-icon.png" alt="App Icon" class="app-icon">
          </div>
          <h1>TugasKu</h1>
        </div>
        <div class="header-actions">
          <!-- Tips (baru) -->
          <button class="icon-btn" id="tipsBtn" title="Tips & Panduan">üí°</button>
          <!-- Notifikasi -->
          <button class="icon-btn" id="notifBtn" title="Notifikasi">
            üîî
            <span class="badge" id="notifBadge" style="display:none;">0</span>
          </button>
          <!-- Statistik -->
          <button class="icon-btn" id="statsBtn" title="Statistik">üìä</button>
          <!-- Pengaturan -->
          <button class="icon-btn" id="settingsBtn" title="Pengaturan">‚öôÔ∏è</button>
          <!-- Menu Pengaturan -->
          <div class="settings-menu" id="settingsMenu">
            <div class="settings-item" data-action="theme">
              <span>üé®</span> Pilih Tema
            </div>
            <div class="settings-item" data-action="about">
              <span>‚ÑπÔ∏è</span> Tentang
            </div>
            <div class="settings-item" data-action="reset">
              <span>üîÑ</span> Reset Data
            </div>
          </div>
        </div>
      </header>
      <!-- Tab Navigation -->
      <div class="tab-navigation">
        <button class="tab-btn active" data-tab="tasks">Tugas</button>
        <button class="tab-btn" data-tab="schedule">Jadwal</button>
        <button class="tab-btn" data-tab="notes">Catatan</button>
      </div>
      <!-- Tab Content: Tugas -->
      <div class="tab-content active" id="tasksTab">
        <section class="form-section" aria-labelledby="formTitle">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;gap:12px;flex-wrap:wrap">
            <strong id="formTitle" style="font-size:18px;">Tambah Tugas</strong>
            <div class="controls">
              <button id="openFormBtn" class="btn" aria-expanded="false">‚ûï Tambah</button>
              <button id="clearAll" class="filter-btn" title="Hapus semua tugas">üóëÔ∏è Hapus Semua</button>
            </div>
          </div>
          <form id="taskForm" style="display:none" aria-hidden="true" novalidate>
            <div class="field">
              <label for="taskSubject">Mata Pelajaran</label>
              <input type="text" id="taskSubject" placeholder="e.g. Matematika" required>
            </div>
            <div class="field">
              <label for="taskName">Nama Tugas</label>
              <input type="text" id="taskName" placeholder="e.g. PR Halaman 10" required>
            </div>
            <div class="field">
              <label for="taskDeadline">Deadline</label>
              <input type="date" id="taskDeadline" required>
            </div>
            <div class="field">
              <label for="taskNotes">Catatan (Opsional)</label>
              <textarea id="taskNotes" placeholder="Catatan tambahan..."></textarea>
            </div>
            <div class="field">
              <label for="taskPriority">Prioritas</label>
              <select id="taskPriority">
                <option value="low">Rendah</option>
                <option value="medium" selected>Sedang</option>
                <option value="high">Tinggi</option>
              </select>
            </div>
            <div style="display:flex;gap:10px;justify-content:flex-end;margin-top:16px">
              <button type="submit" class="btn">üíæ Simpan</button>
              <button type="button" id="cancelForm" class="filter-btn">‚ùå Batal</button>
            </div>
          </form>
        </section>
        <div class="filter-section" role="region" aria-label="Filter tugas">
          <button class="filter-btn active" data-filter="all">Semua</button>
          <button class="filter-btn" data-filter="new">Baru</button>
          <button class="filter-btn" data-filter="active">Belum Selesai</button>
          <button class="filter-btn" data-filter="done">Selesai</button>
          <button class="filter-btn" data-filter="today">Hari Ini</button>
          <button class="filter-btn" data-filter="tomorrow">Besok</button>
          <button class="filter-btn" data-filter="week">Minggu Ini</button>
          <button class="filter-btn" data-filter="overdue">Terlambat</button>
        </div>
        <div id="taskList">
          <!-- Task cards will be rendered here -->
        </div>
      </div>
      <!-- Tab Content: Jadwal -->
      <div class="tab-content" id="scheduleTab">
        <section class="form-section" aria-labelledby="scheduleFormTitle">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;gap:12px;flex-wrap:wrap">
            <strong id="scheduleFormTitle" style="font-size:18px;">Tambah Jadwal</strong>
            <div class="controls">
              <button id="addScheduleBtn" class="btn">‚ûï Tambah</button>
            </div>
          </div>
          <form id="scheduleForm" style="display:none" aria-hidden="true" novalidate>
            <div class="field">
              <label for="scheduleSubject">Mata Pelajaran</label>
              <input type="text" id="scheduleSubject" placeholder="e.g. Matematika" required>
            </div>
            <div class="field">
              <label for="scheduleDay">Hari</label>
              <select id="scheduleDay" required>
                <option value="">Pilih Hari</option>
                <option value="senin">Senin</option>
                <option value="selasa">Selasa</option>
                <option value="rabu">Rabu</option>
                <option value="kamis">Kamis</option>
                <option value="jumat">Jumat</option>
                <option value="sabtu">Sabtu</option>
              </select>
            </div>
            <div class="field">
              <label for="scheduleTime">Waktu</label>
              <input type="time" id="scheduleTime" required>
            </div>
            <div style="display:flex;gap:10px;justify-content:flex-end;margin-top:16px">
              <button type="submit" class="btn">üíæ Simpan</button>
              <button type="button" id="cancelScheduleForm" class="filter-btn">‚ùå Batal</button>
            </div>
          </form>
        </section>
        <div id="scheduleContainer">
          <!-- Schedule items will be rendered here -->
        </div>
      </div>
      <!-- Tab Content: Catatan -->
      <div class="tab-content" id="notesTab">
        <section class="form-section" aria-labelledby="notesFormTitle">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;gap:12px;flex-wrap:wrap">
            <strong id="notesFormTitle" style="font-size:18px;">Tambah Catatan</strong>
            <div class="controls">
              <button id="addNoteBtn" class="btn">‚ûï Tambah</button>
            </div>
          </div>
          <form id="noteForm" style="display:none" aria-hidden="true" novalidate>
            <div class="field">
              <label for="noteTitle">Judul Catatan</label>
              <input type="text" id="noteTitle" placeholder="Judul catatan..." required>
            </div>
            <div class="field">
              <label for="noteContent">Isi Catatan</label>
              <textarea id="noteContent" placeholder="Tulis catatan Anda di sini..." rows="6" required></textarea>
            </div>
            <div style="display:flex;gap:10px;justify-content:flex-end;margin-top:16px">
              <button type="submit" class="btn">üíæ Simpan</button>
              <button type="button" id="cancelNoteForm" class="filter-btn">‚ùå Batal</button>
            </div>
          </form>
        </section>
        <div id="notesList">
          <!-- Notes will be rendered here -->
        </div>
      </div>
    </div>
    <!-- Floating Action Button -->
    <button class="fab" id="fab" title="Tambah Tugas/Jadwal/Catatan">+</button>
    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>
    <!-- Watermark -->
    <div class="watermark">by : Rahmat - v1.2.0</div>
  </div>
  <!-- Modal About -->
  <div class="modal-overlay" id="aboutModal">
    <div class="modal">
      <div class="modal-header">
        <h3>Tentang TugasKu</h3>
        <button class="modal-close" id="closeAboutModal">&times;</button>
      </div>
      <div class="about-section">
        <div class="about-logo">
          <div class="logo">
            <img src="my-icon.png" alt="App Icon" class="app-icon">
          </div>
          <h2>TugasKu</h2>
          <p>Aplikasi Manajemen Tugas Sederhana</p>
        </div>
        <h3>Fitur Utama</h3>
        <ul class="feature-list">
          <li>üìù Tambah dan kelola tugas harian</li>
          <li>üìÖ Jadwal pelajaran mingguan</li>
          <li>üìù Catatan pribadi</li>
          <li>üè∑Ô∏è Filter tugas berdasarkan status dan deadline</li>
          <li>üé® Pilihan tema yang beragam</li>
          <li>üíæ Data tersimpan di browser (localStorage)</li>
          <li>üì± Responsif untuk mobile dan desktop</li>
        </ul>
        <h3 style="margin-top: 16px;">Versi: 1.2.0</h3>
        <p style="margin-top: 8px;">Tanggal Rilis: 30 Agustus 2025</p>
        <p style="margin-top: 8px;">Pengembang: Rahmat, pelajar MA kelas 11</p>
        <p style="margin-top: 8px;">Dibuat sepenuhnya menggunakan Mobile (hp)</p>
        <p style="margin-top: 8px;">üì© Kontak: <a href="mailto:rohmatulloh.3609@gmail.com" style="color: var(--primary);">rohmatulloh.3609@gmail.com</a></p>
        <h3 style="margin-top: 24px;">Deskripsi</h3>
        <p>TugasKu adalah aplikasi manajemen tugas sederhana yang dirancang untuk membantu siswa mengatur tugas sekolah mereka dengan mudah. Dengan antarmuka yang bersih dan fitur yang lengkap, pengguna dapat dengan cepat menambahkan, melihat, dan mengelola tugas, jadwal pelajaran, serta catatan pribadi mereka.</p>
        <div class="version-info">
          <p>¬© 2025 TugasKu. Hak Cipta Dilindungi.</p>
        </div>
      </div>
    </div>
  </div>
  <!-- Theme Selection Modal -->
  <div class="modal-overlay" id="themeModal">
    <div class="modal">
      <div class="modal-header">
        <h3>Pilih Tema</h3>
        <button class="modal-close" id="closeThemeModal">&times;</button>
      </div>
      <div class="about-section">
        <div class="theme-option" data-theme="light">
          <div class="theme-preview" style="background: linear-gradient(135deg, #3B82F6, #2563EB);">‚òÄÔ∏è</div>
          <div>
            <div style="font-weight: 600;">Terang</div>
            <div style="font-size: 12px; color: var(--muted);">Tema terang standar</div>
          </div>
        </div>
        <div class="theme-option" data-theme="dark-mode">
          <div class="theme-preview" style="background: linear-gradient(135deg, #0b1220, #0f1724);">üåô</div>
          <div>
            <div style="font-weight: 600;">Gelap</div>
            <div style="font-size: 12px; color: var(--muted);">Tema gelap standar</div>
          </div>
        </div>
        <div class="theme-option" data-theme="colorful-mode">
          <div class="theme-preview" style="background: linear-gradient(135deg, #8B5CF6, #EC4899);">üé®</div>
          <div>
            <div style="font-weight: 600;">Colorful (Terang)</div>
            <div style="font-size: 12px; color: var(--muted);">Tema warna-warni terang</div>
          </div>
        </div>
        <div class="theme-option" data-theme="dark-mode colorful-mode">
          <div class="theme-preview" style="background: linear-gradient(135deg, #1e1b2e, #2a2540);">üé®</div>
          <div>
            <div style="font-weight: 600;">Colorful (Gelap)</div>
            <div style="font-size: 12px; color: var(--muted);">Tema warna-warni gelap</div>
          </div>
        </div>
        <div class="theme-option" data-theme="forest-mode">
          <div class="theme-preview" style="background: linear-gradient(135deg, #10b981, #059669);">üå≤</div>
          <div>
            <div style="font-weight: 600;">Forest (Terang)</div>
            <div style="font-size: 12px; color: var(--muted);">Tema hijau alami terang</div>
          </div>
        </div>
        <div class="theme-option" data-theme="dark-mode forest-mode">
          <div class="theme-preview" style="background: linear-gradient(135deg, #064e3b, #047857);">üå≤</div>
          <div>
            <div style="font-weight: 600;">Forest (Gelap)</div>
            <div style="font-size: 12px; color: var(--muted);">Tema hijau alami gelap</div>
          </div>
        </div>
        <div class="theme-option" data-theme="dark-mode ocean-mode">
          <div class="theme-preview" style="background: linear-gradient(135deg,#082f49,#0c4a6e);">üåä</div>
          <div>
            <div style="font-weight:600;">Ocean (Gelap)</div>
            <div style="font-size:12px;color:var(--muted);">Biru laut malam</div>
          </div>
        </div>
        <div class="theme-option" data-theme="sakura-mode">
          <div class="theme-preview" style="background: linear-gradient(135deg,#f472b6,#ec4899);">üå∏</div>
          <div>
            <div style="font-weight:600;">Sakura</div>
            <div style="font-size:12px;color:var(--muted);">Pink blossom lembut</div>
          </div>
        </div>
        <div class="theme-option" data-theme="dark-mode sakura-mode">
          <div class="theme-preview" style="background: linear-gradient(135deg,#881337,#9f1239);">üå∏</div>
          <div>
            <div style="font-weight:600;">Sakura (Gelap)</div>
            <div style="font-size:12px;color:var(--muted);">Pink blossom malam</div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Tips Modal (baru) -->
  <div class="modal-overlay" id="tipsModal">
    <div class="modal">
      <div class="modal-header">
        <h3>Tips & Panduan Singkat</h3>
        <button class="modal-close" id="closeTipsModal">&times;</button>
      </div>
      <div class="about-section">
        <h4>Indikator Prioritas</h4>
        <p>Setiap tugas memiliki indikator prioritas berbentuk lingkaran berwarna di kiri judul:</p>
        <ul>
          <li><strong style="color:var(--priority-high)">‚óè</strong> Merah = Prioritas Tinggi</li>
          <li><strong style="color:var(--priority-medium)">‚óè</strong> Kuning = Prioritas Sedang</li>
          <li><strong style="color:var(--priority-low)">‚óè</strong> Hijau = Prioritas Rendah</li>
        </ul>
        <h4>Teks Panjang</h4>
        <p>Nama tugas dan catatan kini dapat membungkus dan memiliki scrollbar bila sangat panjang. Arahkan kursor untuk melihat tooltip jika teks dipotong.</p>
        <h4>Filter & Notifikasi</h4>
        <p>Gunakan filter untuk melihat tugas berdasarkan status atau tanggal. Ikon notifikasi menampilkan jumlah tugas terlambat.</p>
        <h4>Tambah & Edit</h4>
        <p>Gunakan tombol ‚ûï atau FAB untuk menambah Tugas/Jadwal/Catatan. Untuk mengedit tugas, klik tombol ‚úèÔ∏è pada kartu tugas.</p>
      </div>
    </div>
  </div>
  <!-- Stats Modal -->
  <div class="modal-overlay" id="statsModal">
    <div class="modal">
      <div class="modal-header">
        <h3>Statistik Tugas</h3>
        <button class="modal-close" id="closeStatsModal">&times;</button>
      </div>
      <div class="about-section">
        <!-- Charts: Status & Priority -->
        <div class="chart-wrap">
          <canvas id="statusChart" class="chart-canvas"></canvas>
        </div>
        <div class="chart-wrap">
          <canvas id="priorityChart" class="chart-canvas"></canvas>
        </div>
        <!-- Numeric summary (kept below charts for quick glance) -->
        <div style="margin-top: 12px;">
          <h4>Ringkasan</h4>
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-value" id="totalTasks">0</div>
              <div class="stat-label">Total Tugas</div>
            </div>
            <div class="stat-card">
              <div class="stat-value" id="completedTasks">0</div>
              <div class="stat-label">Selesai</div>
            </div>
            <div class="stat-card">
              <div class="stat-value" id="pendingTasks">0</div>
              <div class="stat-label">Belum Selesai</div>
            </div>
            <div class="stat-card">
              <div class="stat-value" id="overdueTasks">0</div>
              <div class="stat-label">Terlambat</div>
            </div>
          </div>
          <div style="margin-top: 24px;">
            <h4>Prioritas Tugas</h4>
            <div class="stats-grid">
              <div class="stat-card">
                <div class="stat-value" id="highPriorityTasks">0</div>
                <div class="stat-label">Tinggi</div>
              </div>
              <div class="stat-card">
                <div class="stat-value" id="mediumPriorityTasks">0</div>
                <div class="stat-label">Sedang</div>
              </div>
              <div class="stat-card">
                <div class="stat-value" id="lowPriorityTasks">0</div>
                <div class="stat-label">Rendah</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Chart.js CDN (simple, lightweight) -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    // Existing application code dengan penambahan fitur tahap 3 dan Tips modal
    (function(){
      // State management
      let tasks = [];
      let schedules = [];
      let notes = [];
      let currentFilter = 'all';
      let searchQuery = '';
      let currentTab = 'tasks';
      let currentTheme = localStorage.getItem('theme') || 'light';
      const STORAGE_KEYS = {
        TASKS: 'pr_tasks_v3',
        SCHEDULES: 'pr_schedules_v1',
        NOTES: 'pr_notes_v1',
        SETTINGS: 'pr_settings_v1'
      };
      // DOM elements
      const taskForm = document.getElementById('taskForm');
      const scheduleForm = document.getElementById('scheduleForm');
      const noteForm = document.getElementById('noteForm');
      const openFormBtn = document.getElementById('openFormBtn');
      const addScheduleBtn = document.getElementById('addScheduleBtn');
      const addNoteBtn = document.getElementById('addNoteBtn');
      const cancelFormBtn = document.getElementById('cancelForm');
      const cancelScheduleFormBtn = document.getElementById('cancelScheduleForm');
      const cancelNoteFormBtn = document.getElementById('cancelNoteForm');
      const clearAllBtn = document.getElementById('clearAll');
      const taskList = document.getElementById('taskList');
      const scheduleContainer = document.getElementById('scheduleContainer');
      const notesList = document.getElementById('notesList');
      const filterButtons = document.querySelectorAll('.filter-btn[data-filter]');
      const tabButtons = document.querySelectorAll('.tab-btn');
      const fab = document.getElementById('fab');
      const toastEl = document.getElementById('toast');
      const settingsBtn = document.getElementById('settingsBtn');
      const settingsMenu = document.getElementById('settingsMenu');
      const settingsItems = document.querySelectorAll('.settings-item');
      const aboutModal = document.getElementById('aboutModal');
      const closeAboutModal = document.getElementById('closeAboutModal');
      const themeModal = document.getElementById('themeModal');
      const closeThemeModal = document.getElementById('closeThemeModal');
      const themeOptions = document.querySelectorAll('.theme-option');
      const notifBtn = document.getElementById('notifBtn');
      const notifBadge = document.getElementById('notifBadge');
      const statsBtn = document.getElementById('statsBtn');
      const statsModal = document.getElementById('statsModal');
      const closeStatsModal = document.getElementById('closeStatsModal');
      const totalTasksEl = document.getElementById('totalTasks');
      const completedTasksEl = document.getElementById('completedTasks');
      const pendingTasksEl = document.getElementById('pendingTasks');
      const overdueTasksEl = document.getElementById('overdueTasks');
      const highPriorityTasksEl = document.getElementById('highPriorityTasks');
      const mediumPriorityTasksEl = document.getElementById('mediumPriorityTasks');
      const lowPriorityTasksEl = document.getElementById('lowPriorityTasks');
      // Tips modal elements (baru)
      const tipsBtn = document.getElementById('tipsBtn');
      const tipsModal = document.getElementById('tipsModal');
      const closeTipsModal = document.getElementById('closeTipsModal');
      // Chart instances
      let statusChart = null;
      let priorityChart = null;
      // Initialize min date for deadline input
      function setMinDeadline() {
        const today = new Date().toISOString().split('T')[0];
        const el = document.getElementById('taskDeadline');
        if (el) el.min = today;
      }
      // Initialize theme
      function initTheme() {
        document.body.className = currentTheme;
      }
      // Save theme preference
      function saveTheme() {
        localStorage.setItem('theme', currentTheme);
      }
      // Set theme
      function setTheme(theme) {
        currentTheme = theme;
        initTheme();
        saveTheme();
        showToast('Tema diubah');
      }
      // Toggle settings menu
      function toggleSettingsMenu() {
        settingsMenu.classList.toggle('show');
      }
      // Close settings menu if clicked outside
      function closeSettingsMenu(e) {
        if (!settingsBtn.contains(e.target) && !settingsMenu.contains(e.target)) {
          settingsMenu.classList.remove('show');
        }
      }
      // Show about modal
      function showAboutModal() {
        aboutModal.classList.add('show');
      }
      // Close about modal
      function closeAboutModalFunc() {
        aboutModal.classList.remove('show');
      }
      // Show theme modal
      function showThemeModal() {
        themeModal.classList.add('show');
        settingsMenu.classList.remove('show');
      }
      // Close theme modal
      function closeThemeModalFunc() {
        themeModal.classList.remove('show');
      }
      // Show stats modal
      function showStatsModal() {
        updateStats();
        statsModal.classList.add('show');
        setTimeout(() => {
          createOrUpdateCharts();
        }, 80);
      }
      // Close stats modal
      function closeStatsModalFunc() {
        statsModal.classList.remove('show');
      }
      // Tips modal controls
      function showTipsModal() {
        tipsModal.classList.add('show');
      }
      function closeTipsModalFunc() {
        tipsModal.classList.remove('show');
      }
      // Helper to read theme-aware colors from computed styles
      function getThemeColors() {
        const computed = getComputedStyle(document.body);
        const primary = computed.getPropertyValue('--primary').trim() || '#3B82F6';
        const success = computed.getPropertyValue('--success').trim() || '#10b981';
        const warning = computed.getPropertyValue('--warning').trim() || '#f59e0b';
        const danger = computed.getPropertyValue('--danger').trim() || '#ef4444';
        const pHigh = computed.getPropertyValue('--priority-high').trim() || danger; // Fix typo here
        const pMed = computed.getPropertyValue('--priority-medium').trim() || warning;
        const pLow = computed.getPropertyValue('--priority-low').trim() || success;
        return { primary, success, warning, danger, pHigh, pMed, pLow };
      }
      // Create or update Chart.js charts
      function createOrUpdateCharts() {
        // Gather data
        const totalTasks = tasks.length;
        const completed = tasks.filter(t => t.status === 'done').length;
        const pending = tasks.filter(t => t.status !== 'done').length;
        const overdue = tasks.filter(t => isOverdue(t.deadline) && t.status !== 'done').length;
        const highPriority = tasks.filter(t => t.priority === 'high').length;
        const mediumPriority = tasks.filter(t => t.priority === 'medium').length;
        const lowPriority = tasks.filter(t => t.priority === 'low').length;
        // Colors based on active theme
        const colors = getThemeColors();
        // Status Chart (Total / Selesai / Belum Selesai / Terlambat)
        const statusCtx = document.getElementById('statusChart').getContext('2d');
        if (statusChart) statusChart.destroy();
        statusChart = new Chart(statusCtx, {
          type: 'bar',
          data: {
            labels: ['Total', 'Selesai', 'Belum Selesai', 'Terlambat'],
            datasets: [{
              label: 'Jumlah',
              data: [totalTasks, completed, pending, overdue],
              backgroundColor: [
                colors.primary,
                colors.success,
                colors.warning,
                colors.danger
              ],
              borderRadius: 8,
              barPercentage: 0.6,
              categoryPercentage: 0.7
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            animation: {
              duration: 700,
              easing: 'easeOutQuart'
            },
            plugins: {
              legend: { display: false },
              tooltip: { enabled: true }
            },
            scales: {
              x: {
                ticks: { color: getComputedStyle(document.body).getPropertyValue('--muted').trim() || '#6b7280' },
                grid: { display: false }
              },
              y: {
                beginAtZero: true,
                ticks: { precision:0, color: getComputedStyle(document.body).getPropertyValue('--muted').trim() || '#6b7280' },
                grid: { color: 'rgba(0,0,0,0.04)' }
              }
            }
          }
        });
        // Priority Chart (High / Medium / Low)
        const priorityCtx = document.getElementById('priorityChart').getContext('2d');
        if (priorityChart) priorityChart.destroy();
        priorityChart = new Chart(priorityCtx, {
          type: 'bar',
          data: {
            labels: ['Tinggi', 'Sedang', 'Rendah'],
            datasets: [{
              label: 'Jumlah',
              data: [highPriority, mediumPriority, lowPriority],
              backgroundColor: [colors.pHigh, colors.pMed, colors.pLow],
              borderRadius: 8,
              barPercentage: 0.6,
              categoryPercentage: 0.7
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            animation: {
              duration: 700,
              easing: 'easeOutQuart'
            },
            plugins: {
              legend: { display: false },
              tooltip: { enabled: true }
            },
            scales: {
              x: {
                ticks: { color: getComputedStyle(document.body).getPropertyValue('--muted').trim() || '#6b7280' },
                grid: { display: false }
              },
              y: {
                beginAtZero: true,
                ticks: { precision:0, color: getComputedStyle(document.body).getPropertyValue('--muted').trim() || '#6b7280' },
                grid: { color: 'rgba(0,0,0,0.04)' }
              }
            }
          }
        });
      }
      // Update stats values
      function updateStats() {
        const totalTasks = tasks.length;
        const completedTasks = tasks.filter(task => task.status === 'done').length;
        const pendingTasks = totalTasks - completedTasks;
        const overdueTasks = tasks.filter(task => isOverdue(task.deadline) && task.status !== 'done').length;
        const highPriorityTasks = tasks.filter(task => task.priority === 'high').length;
        const mediumPriorityTasks = tasks.filter(task => task.priority === 'medium').length;
        const lowPriorityTasks = tasks.filter(task => task.priority === 'low').length;
        totalTasksEl.textContent = totalTasks;
        completedTasksEl.textContent = completedTasks;
        pendingTasksEl.textContent = pendingTasks;
        overdueTasksEl.textContent = overdueTasks;
        highPriorityTasksEl.textContent = highPriorityTasks;
        mediumPriorityTasksEl.textContent = mediumPriorityTasks;
        lowPriorityTasksEl.textContent = lowPriorityTasks;
        // Update charts if they exist (so stats update live when modal open)
        if (statsModal.classList.contains('show')) {
          createOrUpdateCharts();
        }
      }
      // Update notification badge (example logic)
      function updateNotifBadge() {
        const overdueCount = tasks.filter(task => isOverdue(task.deadline) && task.status !== 'done').length;
        if (overdueCount > 0) {
            notifBadge.textContent = overdueCount;
            notifBadge.style.display = 'flex';
        } else {
            notifBadge.style.display = 'none';
        }
      }
      // Handle settings actions
      function handleSettingsAction(action) {
        switch(action) {
          case 'about':
            showAboutModal();
            settingsMenu.classList.remove('show');
            break;
          case 'theme':
            showThemeModal();
            break;
          case 'reset':
            if (confirm('Apakah Anda yakin ingin mereset semua data?')) {
              localStorage.removeItem(STORAGE_KEYS.TASKS);
              localStorage.removeItem(STORAGE_KEYS.SCHEDULES);
              localStorage.removeItem(STORAGE_KEYS.NOTES);
              tasks = [];
              schedules = [];
              notes = [];
              renderTasks();
              renderSchedules();
              renderNotes();
              updateBadge();
              updateNotifBadge();
              showToast('Data telah direset');
            }
            settingsMenu.classList.remove('show');
            break;
        }
      }
      // Toggle task form visibility
      function toggleForm(show) {
        const isVisible = taskForm.style.display !== 'none';
        const shouldShow = typeof show === 'boolean' ? show : !isVisible;
        taskForm.style.display = shouldShow ? 'block' : 'none';
        openFormBtn.setAttribute('aria-expanded', shouldShow);
        taskForm.setAttribute('aria-hidden', !shouldShow);
        if (!shouldShow) {
          taskForm.reset();
        }
      }
      // Toggle schedule form visibility
      function toggleScheduleForm(show) {
        const isVisible = scheduleForm.style.display !== 'none';
        const shouldShow = typeof show === 'boolean' ? show : !isVisible;
        scheduleForm.style.display = shouldShow ? 'block' : 'none';
        addScheduleBtn.setAttribute('aria-expanded', shouldShow);
        scheduleForm.setAttribute('aria-hidden', !shouldShow);
        if (!shouldShow) {
          scheduleForm.reset();
        }
      }
      // Toggle note form visibility
      function toggleNoteForm(show) {
        const isVisible = noteForm.style.display !== 'none';
        const shouldShow = typeof show === 'boolean' ? show : !isVisible;
        noteForm.style.display = shouldShow ? 'block' : 'none';
        addNoteBtn.setAttribute('aria-expanded', shouldShow);
        noteForm.setAttribute('aria-hidden', !shouldShow);
        if (!shouldShow) {
          noteForm.reset();
        }
      }
      // Switch tabs
      function switchTab(tabName) {
        tabButtons.forEach(btn => {
          if (btn.dataset.tab === tabName) {
            btn.classList.add('active');
          } else {
            btn.classList.remove('active');
          }
        });
        document.querySelectorAll('.tab-content').forEach(content => {
          if (content.id === `${tabName}Tab`) {
            content.classList.add('active');
          } else {
            content.classList.remove('active');
          }
        });
        currentTab = tabName;
        fab.style.display = 'flex';
      }
      // Update badge count (keeps previous behavior)
      function updateBadge() {
        const activeTasks = tasks.filter(task => task.status !== 'done').length;
        const badge = document.querySelector('.badge');
        if (badge && badge.id !== 'notifBadge') {
          badge.textContent = activeTasks;
          badge.style.display = activeTasks > 0 ? 'flex' : 'none';
        }
      }
      // Format date to human readable
      function formatDate(dateStr) {
        const date = new Date(dateStr);
        if (isNaN(date)) return dateStr;
        const today = new Date();
        const tomorrow = new Date(today);
        tomorrow.setDate(tomorrow.getDate() + 1);
        if (date.getDate() === today.getDate() &&
            date.getMonth() === today.getMonth() &&
            date.getFullYear() === today.getFullYear()) {
          return 'Hari Ini';
        }
        if (date.getDate() === tomorrow.getDate() &&
            date.getMonth() === tomorrow.getMonth() &&
            date.getFullYear() === tomorrow.getFullYear()) {
          return 'Besok';
        }
        const day = date.getDate().toString().padStart(2, '0');
        const month = (date.getMonth() + 1).toString().padStart(2, '0');
        const year = date.getFullYear();
        return `${day}/${month}/${year}`;
      }
      // Get relative time text
      function getRelativeTime(dateStr) {
        const date = new Date(dateStr);
        const now = new Date();
        const diffTime = date - now;
        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
        if (diffDays < 0) return 'Terlambat';
        if (diffDays === 0) return 'Hari Ini';
        if (diffDays === 1) return 'Besok';
        return `${diffDays} hari lagi`;
      }
      // Format timestamp for notes
      function formatTimestamp(timestamp) {
        const date = new Date(timestamp);
        return date.toLocaleString('id-ID', {
          year: 'numeric',
          month: 'short',
          day: 'numeric',
          hour: '2-digit',
          minute: '2-digit'
        });
      }
      // Check if date is today
      function isToday(dateStr) {
        const date = new Date(dateStr);
        const today = new Date();
        return date.getDate() === today.getDate() &&
               date.getMonth() === today.getMonth() &&
               date.getFullYear() === today.getFullYear();
      }
      // Check if date is tomorrow
      function isTomorrow(dateStr) {
        const date = new Date(dateStr);
        const tomorrow = new Date();
        tomorrow.setDate(tomorrow.getDate() + 1);
        return date.getDate() === tomorrow.getDate() &&
               date.getMonth() === tomorrow.getMonth() &&
               date.getFullYear() === tomorrow.getFullYear();
      }
      // Check if date is this week
      function isThisWeek(dateStr) {
        const date = new Date(dateStr);
        const today = new Date();
        const firstDayOfWeek = new Date(today.setDate(today.getDate() - today.getDay() + 1));
        firstDayOfWeek.setHours(0,0,0,0);
        const lastDayOfWeek = new Date(firstDayOfWeek);
        lastDayOfWeek.setDate(lastDayOfWeek.getDate() + 6);
        lastDayOfWeek.setHours(23,59,59,999);
        return date >= firstDayOfWeek && date <= lastDayOfWeek;
      }
      // Check if task is overdue
      function isOverdue(dateStr) {
        const date = new Date(dateStr);
        const today = new Date();
        today.setHours(0, 0, 0, 0);
        return date < today;
      }
      // Filter tasks based on current filter
      function filterTasks() {
        return tasks.filter(task => {
          switch(currentFilter) {
            case 'all':
              return true;
            case 'new':
              return task.status === 'new';
            case 'active':
              return task.status !== 'done';
            case 'done':
              return task.status === 'done';
            case 'today': {
              return isToday(task.deadline) && task.status !== 'done';
            }
            case 'tomorrow': {
              return isTomorrow(task.deadline) && task.status !== 'done';
            }
            case 'week': {
              return isThisWeek(task.deadline) && task.status !== 'done';
            }
            case 'overdue':
              return isOverdue(task.deadline) && task.status !== 'done';
            default:
              return true;
          }
        });
      }
      // Render tasks with priority indicator (visual) and improved text wrapping
      function renderTasks() {
        const filteredTasks = filterTasks();
        // Sort tasks: priority (high > medium > low) then by deadline
        filteredTasks.sort((a, b) => {
          const priorityOrder = { high: 0, medium: 1, low: 2 };
          if ((priorityOrder[a.priority] || 2) !== (priorityOrder[b.priority] || 2)) {
            return (priorityOrder[a.priority] || 2) - (priorityOrder[b.priority] || 2);
          }
          return new Date(a.deadline) - new Date(b.deadline);
        });
        if (filteredTasks.length === 0) {
          taskList.innerHTML = `
            <div class="empty-state">
              <div style="font-size:48px;margin-bottom:16px;">üìã</div>
              <h3>Tidak ada tugas</h3>
              <p>Tambahkan tugas baru untuk memulai</p>
            </div>
          `;
          updateBadge();
          updateNotifBadge();
          return;
        }
        taskList.innerHTML = filteredTasks.map(task => {
          // Determine status text and color
          let statusText = '';
          let statusColor = '';
          switch (task.status) {
            case 'new':
              statusText = 'Baru';
              statusColor = 'var(--warning)';
              break;
            case 'opened':
              statusText = 'Dibaca';
              statusColor = 'var(--primary)';
              break;
            case 'done':
              statusText = 'Selesai';
              statusColor = 'var(--success)';
              break;
            default:
              statusText = 'Baru';
              statusColor = 'var(--warning)';
          }
          // Priority indicator classes and tooltip
          let indicatorClass = 'priority-low-indicator';
          let indicatorTitle = 'Prioritas: Rendah';
          switch (task.priority) {
            case 'high':
              indicatorClass = 'priority-high-indicator';
              indicatorTitle = 'Prioritas: Tinggi';
              break;
            case 'medium':
              indicatorClass = 'priority-medium-indicator';
              indicatorTitle = 'Prioritas: Sedang';
              break;
            case 'low':
            default:
              indicatorClass = 'priority-low-indicator';
              indicatorTitle = 'Prioritas: Rendah';
          }
          // Determine deadline class
          let deadlineClass = '';
          if (task.status === 'done') {
            deadlineClass = 'dl-ok';
          } else if (isOverdue(task.deadline)) {
            deadlineClass = 'dl-overdue';
          } else {
            const daysDiff = Math.ceil((new Date(task.deadline) - new Date()) / (1000 * 60 * 60 * 24));
            if (daysDiff < 0) {
              deadlineClass = 'dl-overdue';
            } else if (daysDiff === 0) {
              deadlineClass = 'dl-urgent';
            } else if (daysDiff === 1) {
              deadlineClass = 'dl-soon';
            } else if (daysDiff <= 3) {
              deadlineClass = 'dl-soon';
            } else {
              deadlineClass = 'dl-ok';
            }
          }
          // Use title attribute for tooltip when truncated
          const titleAttr = `${task.subject} - ${task.name}`.replace(/"/g, '&quot;');
          // Notes handling (long content scroll)
          const notesHtml = task.notes ? `<div class="task-detail"><div class="long-text" title="${(task.notes||'').replace(/"/g,'&quot;')}">üìù ${task.notes}</div></div>` : '';
          return `
            <div class="task-card ${deadlineClass} priority-${task.priority}" data-id="${task.id}">
              <div class="task-title">
                <span class="priority-indicator ${indicatorClass}" title="${indicatorTitle}" aria-hidden="true"></span>
                <span class="title-text" title="${titleAttr}">${task.subject} - ${task.name}</span>
              </div>
              <div class="task-detail">
                <span title="${formatDate(task.deadline)}">üìÖ ${formatDate(task.deadline)}</span>
                <span title="${getRelativeTime(task.deadline)}">‚è∞ ${getRelativeTime(task.deadline)}</span>
              </div>
              ${notesHtml}
              <div class="status-pill" style="background:${statusColor};color:#fff">${statusText}</div>
              <div class="task-actions">
                <button class="filter-btn" onclick="handleTaskAction('${task.id}', 'toggle')">
                  ${task.status === 'done' ? '‚Ü©Ô∏è Batal' : '‚úÖ Selesai'}
                </button>
                <button class="filter-btn" onclick="handleTaskAction('${task.id}', 'edit')">‚úèÔ∏è Edit</button>
                <button class="filter-btn" onclick="handleTaskAction('${task.id}', 'delete')">üóëÔ∏è Hapus</button>
              </div>
            </div>
          `;
        }).join('');
        updateBadge();
        updateNotifBadge();
      }
      // Render schedules
      function renderSchedules() {
        if (schedules.length === 0) {
          scheduleContainer.innerHTML = `
            <div class="empty-state">
              <div style="font-size:48px;margin-bottom:16px;">üìÖ</div>
              <h3>Belum ada jadwal</h3>
              <p>Tambahkan jadwal pelajaran Anda</p>
            </div>
          `;
          return;
        }
        const days = ['senin', 'selasa', 'rabu', 'kamis', 'jumat', 'sabtu'];
        const schedulesByDay = {};
        days.forEach(day => {
          schedulesByDay[day] = schedules.filter(schedule => schedule.day === day);
        });
        days.forEach(day => {
          schedulesByDay[day].sort((a, b) => a.time.localeCompare(b.time));
        });
        scheduleContainer.innerHTML = days.map(day => {
          if (!schedulesByDay[day] || schedulesByDay[day].length === 0) return '';
          const dayNames = { 'senin': 'Senin', 'selasa': 'Selasa', 'rabu': 'Rabu', 'kamis': 'Kamis', 'jumat': 'Jumat', 'sabtu': 'Sabtu' }; // Fix typo here
          return `
            <div class="schedule-day">
              <div class="schedule-header">${dayNames[day]}</div>
              ${schedulesByDay[day].map(schedule => `
                <div class="schedule-item">
                  <div class="schedule-time">${schedule.time}</div>
                  <div class="schedule-subject">${schedule.subject}</div>
                  <div>
                    <button class="filter-btn" onclick="handleScheduleAction('${schedule.id}', 'edit')">‚úèÔ∏è</button>
                    <button class="filter-btn" onclick="handleScheduleAction('${schedule.id}', 'delete')">üóëÔ∏è</button>
                  </div>
                </div>
              `).join('')}
            </div>
          `;
        }).join('');
      }
      // Render notes
      function renderNotes() {
        if (notes.length === 0) {
          notesList.innerHTML = `
            <div class="empty-state">
              <div style="font-size:48px;margin-bottom:16px;">üìù</div>
              <h3>Belum ada catatan</h3>
              <p>Tambahkan catatan baru untuk memulai</p>
            </div>
          `;
          return;
        }
        notes.sort((a, b) => b.updatedAt - a.updatedAt);
        notesList.innerHTML = notes.map(note => `
          <div class="note-card" data-id="${note.id}">
            <div class="note-title">${note.title}</div>
            <div class="note-content">${note.content}</div>
            <div class="note-meta">
              Dibuat: ${formatTimestamp(note.createdAt)}<br>
              Diupdate: ${formatTimestamp(note.updatedAt)}
            </div>
            <div class="note-actions">
              <button class="filter-btn" onclick="handleNoteAction('${note.id}', 'edit')">‚úèÔ∏è Edit</button>
              <button class="filter-btn" onclick="handleNoteAction('${note.id}', 'delete')">üóëÔ∏è Hapus</button>
            </div>
          </div>
        `).join('');
      }
      // Handle task actions (toggle, edit, delete)
      function handleTaskAction(taskId, action) {
        const taskIndex = tasks.findIndex(t => t.id == taskId);
        if (taskIndex === -1) return;
        const task = tasks[taskIndex];
        switch(action) {
          case 'toggle':
            task.status = task.status === 'done' ? 'active' : 'done';
            saveTasks();
            renderTasks();
            showToast(task.status === 'done' ? 'Tugas selesai!' : 'Tugas dibatalkan');
            break;
          case 'edit':
            document.getElementById('taskSubject').value = task.subject;
            document.getElementById('taskName').value = task.name;
            document.getElementById('taskDeadline').value = task.deadline;
            document.getElementById('taskNotes').value = task.notes || '';
            document.getElementById('taskPriority').value = task.priority || 'medium';
            tasks.splice(taskIndex, 1);
            saveTasks();
            updateBadge();
            toggleForm(true);
            window.scrollTo({ top: 0, behavior: 'smooth' });
            showToast('Edit tugas');
            break;
          case 'delete':
            if (confirm('Apakah Anda yakin ingin menghapus tugas ini?')) {
              tasks.splice(taskIndex, 1);
              saveTasks();
              renderTasks();
              updateBadge();
              showToast('Tugas dihapus');
            }
            break;
        }
      }
      // Handle schedule actions (edit, delete)
      function handleScheduleAction(scheduleId, action) {
        const scheduleIndex = schedules.findIndex(s => s.id == scheduleId);
        if (scheduleIndex === -1) return;
        const schedule = schedules[scheduleIndex];
        switch(action) {
          case 'edit':
            document.getElementById('scheduleSubject').value = schedule.subject;
            document.getElementById('scheduleDay').value = schedule.day;
            document.getElementById('scheduleTime').value = schedule.time;
            schedules.splice(scheduleIndex, 1);
            saveSchedules();
            toggleScheduleForm(true);
            document.getElementById('scheduleSubject').scrollIntoView({ behavior: 'smooth' });
            showToast('Edit jadwal');
            break;
          case 'delete':
            if (confirm('Apakah Anda yakin ingin menghapus jadwal ini?')) {
              schedules.splice(scheduleIndex, 1);
              saveSchedules();
              renderSchedules();
              showToast('Jadwal dihapus');
            }
            break;
        }
      }
      // Handle note actions (edit, delete)
      function handleNoteAction(noteId, action) {
        const noteIndex = notes.findIndex(n => n.id == noteId);
        if (noteIndex === -1) return;
        const note = notes[noteIndex];
        switch(action) {
          case 'edit':
            document.getElementById('noteTitle').value = note.title;
            document.getElementById('noteContent').value = note.content;
            notes.splice(noteIndex, 1);
            saveNotes();
            toggleNoteForm(true);
            document.getElementById('noteTitle').scrollIntoView({ behavior: 'smooth' });
            showToast('Edit catatan');
            break;
          case 'delete':
            if (confirm('Apakah Anda yakin ingin menghapus catatan ini?')) {
              notes.splice(noteIndex, 1);
              saveNotes();
              renderNotes();
              showToast('Catatan dihapus');
            }
            break;
        }
      }
      // Load tasks from localStorage
      function loadTasks() {
        try {
          const storedTasks = localStorage.getItem(STORAGE_KEYS.TASKS);
          tasks = storedTasks ? JSON.parse(storedTasks) : [];
        } catch (error) {
          console.error('Error loading tasks:', error);
          tasks = [];
          showToast('Gagal memuat tugas');
        }
        updateBadge();
        updateNotifBadge();
        renderTasks();
      }
      // Load schedules from localStorage
      function loadSchedules() {
        try {
          const storedSchedules = localStorage.getItem(STORAGE_KEYS.SCHEDULES);
          schedules = storedSchedules ? JSON.parse(storedSchedules) : [];
        } catch (error) {
          console.error('Error loading schedules:', error);
          schedules = [];
          showToast('Gagal memuat jadwal');
        }
        renderSchedules();
      }
      // Load notes from localStorage
      function loadNotes() {
        try {
          const storedNotes = localStorage.getItem(STORAGE_KEYS.NOTES);
          notes = storedNotes ? JSON.parse(storedNotes) : [];
        } catch (error) {
          console.error('Error loading notes:', error);
          notes = [];
          showToast('Gagal memuat catatan');
        }
        renderNotes();
      }
      // Save tasks to localStorage
      function saveTasks() {
        try {
          localStorage.setItem(STORAGE_KEYS.TASKS, JSON.stringify(tasks));
        } catch (error) {
          console.error('Error saving tasks:', error);
          showToast('Gagal menyimpan tugas');
        }
      }
      // Save schedules to localStorage
      function saveSchedules() {
        try {
          localStorage.setItem(STORAGE_KEYS.SCHEDULES, JSON.stringify(schedules));
        } catch (error) {
          console.error('Error saving schedules:', error);
          showToast('Gagal menyimpan jadwal');
        }
      }
      // Save notes to localStorage
      function saveNotes() {
        try {
          localStorage.setItem(STORAGE_KEYS.NOTES, JSON.stringify(notes));
        } catch (error) {
          console.error('Error saving notes:', error);
          showToast('Gagal menyimpan catatan');
        }
      }
      // Show toast notification
      let toastTimeout = null;
      function showToast(message, duration = 3000) {
        if (toastTimeout) {
          clearTimeout(toastTimeout);
        }
        toastEl.textContent = message;
        toastEl.classList.add('show');
        toastTimeout = setTimeout(() => {
          toastEl.classList.remove('show');
        }, duration);
      }
      // Generate unique ID
      function generateId() {
        return Date.now() + Math.floor(Math.random() * 1000);
      }
      // Initialize event listeners
      function initEventListeners() {
        // Task form submission
        taskForm.addEventListener('submit', function(e) {
          e.preventDefault();
          const subject = document.getElementById('taskSubject').value.trim();
          const name = document.getElementById('taskName').value.trim();
          const deadline = document.getElementById('taskDeadline').value;
          const notesText = document.getElementById('taskNotes').value.trim();
          const priority = document.getElementById('taskPriority').value;
          if (!subject || !name || !deadline) {
            showToast('Harap isi semua field yang diperlukan');
            return;
          }
          const newTask = {
            id: generateId(),
            subject,
            name,
            deadline,
            notes: notesText,
            priority,
            status: 'new',
            createdAt: Date.now()
          };
          tasks.push(newTask);
          saveTasks();
          renderTasks();
          toggleForm(false);
          showToast('Tugas ditambahkan');
        });
        // Schedule form submission
        scheduleForm.addEventListener('submit', function(e) {
          e.preventDefault();
          const subject = document.getElementById('scheduleSubject').value.trim();
          const day = document.getElementById('scheduleDay').value;
          const time = document.getElementById('scheduleTime').value;
          if (!subject || !day || !time) {
            showToast('Harap isi semua field yang diperlukan');
            return;
          }
          const newSchedule = {
            id: generateId(),
            subject,
            day,
            time
          };
          schedules.push(newSchedule);
          saveSchedules();
          renderSchedules();
          toggleScheduleForm(false);
          showToast('Jadwal ditambahkan');
        });
        // Note form submission
        noteForm.addEventListener('submit', function(e) {
          e.preventDefault();
          const title = document.getElementById('noteTitle').value.trim();
          const content = document.getElementById('noteContent').value.trim();
          if (!title || !content) {
            showToast('Harap isi semua field yang diperlukan');
            return;
          }
          const now = Date.now();
          const newNote = {
            id: generateId(),
            title,
            content,
            createdAt: now,
            updatedAt: now
          };
          notes.push(newNote);
          saveNotes();
          renderNotes();
          toggleNoteForm(false);
          showToast('Catatan ditambahkan');
        });
        // Open task form button
        openFormBtn.addEventListener('click', () => toggleForm());
        // Add schedule button
        addScheduleBtn.addEventListener('click', () => toggleScheduleForm());
        // Add note button
        addNoteBtn.addEventListener('click', () => toggleNoteForm());
        // Cancel task form button
        cancelFormBtn.addEventListener('click', () => toggleForm(false));
        // Cancel schedule form button
        cancelScheduleFormBtn.addEventListener('click', () => toggleScheduleForm(false));
        // Cancel note form button
        cancelNoteFormBtn.addEventListener('click', () => toggleNoteForm(false));
        // Clear all tasks button
        clearAllBtn.addEventListener('click', function() {
          if (tasks.length === 0) {
            showToast('Tidak ada tugas untuk dihapus');
            return;
          }
          if (confirm('Apakah Anda yakin ingin menghapus semua tugas?')) {
            tasks = [];
            saveTasks();
            renderTasks();
            updateBadge();
            showToast('Semua tugas dihapus');
          }
        });
        // Filter buttons
        filterButtons.forEach(button => {
          button.addEventListener('click', function() {
            filterButtons.forEach(btn => btn.classList.remove('active'));
            this.classList.add('active');
            currentFilter = this.dataset.filter;
            renderTasks();
          });
        });
        // Tab buttons
        tabButtons.forEach(button => {
          button.addEventListener('click', function() {
            switchTab(this.dataset.tab);
          });
        });
        // FAB button
        fab.addEventListener('click', function() {
          if (currentTab === 'tasks') {
            toggleForm(true);
            document.getElementById('taskSubject').scrollIntoView({ behavior: 'smooth' });
          } else if (currentTab === 'schedule') {
            toggleScheduleForm(true);
            document.getElementById('scheduleSubject').scrollIntoView({ behavior: 'smooth' });
          } else if (currentTab === 'notes') {
            toggleNoteForm(true);
            document.getElementById('noteTitle').scrollIntoView({ behavior: 'smooth' });
          }
        });
        // Settings button
        settingsBtn.addEventListener('click', toggleSettingsMenu);
        // Close settings menu when clicking outside
        document.addEventListener('click', closeSettingsMenu);
        // Settings menu items
        settingsItems.forEach(item => {
          item.addEventListener('click', function() {
            const action = this.dataset.action;
            handleSettingsAction(action);
          });
        });
        // Close about modal
        closeAboutModal.addEventListener('click', closeAboutModalFunc);
        aboutModal.addEventListener('click', function(e) {
          if (e.target === aboutModal) {
            closeAboutModalFunc();
          }
        });
        // Theme selection
        themeOptions.forEach(option => {
          option.addEventListener('click', function() {
            const theme = this.dataset.theme;
            setTheme(theme);
            closeThemeModalFunc();
          });
        });
        closeThemeModal.addEventListener('click', closeThemeModalFunc);
        themeModal.addEventListener('click', function(e) {
          if (e.target === themeModal) {
            closeThemeModalFunc();
          }
        });
        // Stats button
        statsBtn.addEventListener('click', showStatsModal);
        closeStatsModal.addEventListener('click', closeStatsModalFunc);
        statsModal.addEventListener('click', function(e) {
          if (e.target === statsModal) {
            closeStatsModalFunc();
          }
        });
        // Tips button events
        tipsBtn.addEventListener('click', showTipsModal);
        closeTipsModal.addEventListener('click', closeTipsModalFunc);
        tipsModal.addEventListener('click', function(e) {
          if (e.target === tipsModal) {
            closeTipsModalFunc();
          }
        });
        // Notif button (optional action)
        notifBtn.addEventListener('click', function() {
            filterButtons.forEach(btn => btn.classList.remove('active'));
            const overdueBtn = document.querySelector('.filter-btn[data-filter="overdue"]');
            if (overdueBtn) overdueBtn.classList.add('active');
            currentFilter = 'overdue';
            renderTasks();
            switchTab('tasks');
            showToast('Menampilkan tugas terlambat');
        });
        // Make functions globally accessible
        window.handleTaskAction = handleTaskAction;
        window.handleScheduleAction = handleScheduleAction;
        window.handleNoteAction = handleNoteAction;
        window.switchTab = switchTab;
      }
      // Initialize the app
      function init() {
        // Set version in watermark
        const versionMeta = document.querySelector('meta[name="app-version"]');
        if (versionMeta) {
          const versionText = versionMeta.getAttribute('content');
          const watermark = document.querySelector('.watermark');
          if (watermark) {
            watermark.textContent = `by : Rahmat - v${versionText}`;
          }
        }
        // Load saved theme
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme) {
          currentTheme = savedTheme;
        }
        initTheme();
        setMinDeadline();
        loadTasks();
        loadSchedules();
        loadNotes();
        initEventListeners();
        // Set initial tab
        switchTab('tasks');
        showToast('Aplikasi siap digunakan', 2000);
      }
      // Start the application when DOM is loaded
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
      } else {
        init();
      }
    })();
  </script>
<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/sw.js')
      .then(() => console.log('SW registered'))
      .catch(err => console.log('SW failed', err));
  }
</script>
</body>
</html>